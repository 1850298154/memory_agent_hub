你可能是指 Elasticsearch 中的地理距离计算（Geographic Distance Calculation）。在 Elasticsearch 中，用于计算两个地理坐标点之间距离的算法主要有两种：

1. **arc（默认）**：基于地球是球体的弧面距离计算（Haversine 公式）
2. **plane**：基于平面的直线距离计算（欧几里得距离）


### 一、arc 算法（Haversine 公式）
`arc` 是 Elasticsearch 计算地理距离的默认算法，它考虑地球的球形特性，计算两点间的最短球面距离（大圆弧长）。

#### 公式：
```
a = sin²(Δφ/2) + cosφ₁ × cosφ₂ × sin²(Δλ/2)
c = 2 × atan2(√a, √(1−a))
distance = R × c
```

其中：
- `φ₁, φ₂`：两点的纬度（弧度）
- `Δφ`：纬度差（φ₂ - φ₁）
- `Δλ`：经度差（λ₂ - λ₁）
- `R`：地球半径（默认 6371 公里，可自定义）
- `distance`：最终距离


#### 计算示例：
计算北京（39.9042°N, 116.4074°E）到上海（31.2304°N, 121.4737°E）的距离：

1. 将经纬度转换为弧度：
   - 北京：φ₁ = 39.9042° × π/180 ≈ 0.6965 rad，λ₁ = 116.4074° × π/180 ≈ 2.0317 rad
   - 上海：φ₂ = 31.2304° × π/180 ≈ 0.5451 rad，λ₂ = 121.4737° × π/180 ≈ 2.1199 rad

2. 计算差值：
   - Δφ = 0.5451 - 0.6965 ≈ -0.1514 rad
   - Δλ = 2.1199 - 2.0317 ≈ 0.0882 rad

3. 代入公式：
   - a = sin²(-0.1514/2) + cos(0.6965)×cos(0.5451)×sin²(0.0882/2) ≈ 0.0009 + 0.768×0.838×0.00017 ≈ 0.0009 + 0.00011 ≈ 0.00101
   - c = 2 × atan2(√0.00101, √(1-0.00101)) ≈ 2 × 0.0318 ≈ 0.0636 rad
   - distance = 6371 × 0.0636 ≈ **1067 公里**（与实际直线距离相符）


### 二、plane 算法（平面欧几里得距离）
`plane` 算法将地球表面视为平面，用欧几里得公式计算直线距离，适用于小范围区域（如城市内）的快速计算，精度较低。

#### 公式：
```
distance = R × √(Δφ² + (cosφ_avg × Δλ)²)
```

其中：
- `φ_avg`：两点的平均纬度（(φ₁+φ₂)/2）
- 其他参数同 Haversine 公式


#### 计算示例（同一组坐标）：
1. 计算平均纬度：
   - φ_avg = (0.6965 + 0.5451)/2 ≈ 0.6208 rad
   - cos(φ_avg) ≈ 0.807

2. 代入公式：
   - distance = 6371 × √((-0.1514)² + (0.807×0.0882)²)
   - ≈ 6371 × √(0.0229 + 0.0051)
   - ≈ 6371 × √0.028 ≈ 6371 × 0.167 ≈ **1064 公里**（与 arc 结果接近，但对大范围计算误差较大）


### 三、两种算法的对比
| 特性        | arc（Haversine）               | plane（欧几里得）             |
|-------------|--------------------------------|--------------------------------|
| 地球模型    | 球体（真实模型）               | 平面（简化模型）               |
| 精度        | 高（适合远距离计算）           | 低（仅适合小范围，如 <100km）  |
| 计算速度    | 较慢（三角函数运算多）         | 较快（仅基础算术运算）         |
| 适用场景    | 跨城市、跨国距离计算           | 城市内、区域内近距离计算       |
| 误差情况    | 误差极小（地球非完美球体导致） | 距离越远误差越大（如赤道附近） |


### 四、Elasticsearch 中如何指定算法
在地理距离查询（`geo_distance`）中，可通过 `distance_type` 参数指定算法：
```json
{
  "query": {
    "geo_distance": {
      "distance_type": "arc",  // 或 "plane"
      "location": {
        "lat": 39.9042,
        "lon": 116.4074
      },
      "distance": "1000km"
    }
  }
}
```

总结：对于大多数场景，推荐使用默认的 `arc` 算法以保证精度；仅在对性能要求极高且距离范围较小时，才考虑 `plane` 算法。